<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Daily Cleaning Work Schedule</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #f5f5f5;
            padding: 40px 20px;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        h1 {
            text-align: center;
            color: #1a1a1a;
            font-size: 32px;
            font-weight: 700;
            margin-bottom: 30px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .controls {
            text-align: center;
            margin-bottom: 40px;
            padding: 20px;
            background: #ecf0f1;
            border-radius: 4px;
            display: flex;
            justify-content: center;
            gap: 30px;
            flex-wrap: wrap;
        }
        
        .control-group {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .controls label {
            font-size: 18px;
            font-weight: 700;
            color: #2c3e50;
        }
        
        .controls select {
            font-size: 16px;
            padding: 8px 16px;
            border: 2px solid #2c3e50;
            border-radius: 4px;
            background: white;
            font-weight: 600;
            cursor: pointer;
        }
        
        .time-inputs {
            display: flex;
            gap: 5px;
        }
        
        .time-inputs select {
            padding: 8px 12px;
        }
        
        .section {
            margin-bottom: 30px;
        }
        
        .section-header {
            background: #2c3e50;
            color: white;
            padding: 12px 20px;
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 2px;
        }
        
        .task-row {
            display: flex;
            border-bottom: 1px solid #e0e0e0;
            padding: 16px 20px;
            align-items: center;
        }
        
        .task-row:last-child {
            border-bottom: none;
        }
        
        .time {
            font-weight: 700;
            font-size: 16px;
            color: #2c3e50;
            min-width: 140px;
        }
        
        .task {
            flex: 1;
            font-size: 16px;
            color: #333;
        }
        
        .label {
            padding: 6px 14px;
            border-radius: 4px;
            font-size: 13px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .daily {
            background: #3498db;
            color: white;
        }
        
        .heavy {
            background: #e74c3c;
            color: white;
        }
        
        .light {
            background: #2ecc71;
            color: white;
        }
        
        .moderate {
            background: #f39c12;
            color: white;
        }
        
        .break {
            background: #95a5a6;
            color: white;
        }

        .micro-break-divider {
            height: 3px;
            background: #9b59b6;
            margin: 8px 0;
        }
        
        @media print {
            body {
                background: white;
                padding: 0;
            }
            
            .container {
                box-shadow: none;
                padding: 20px;
            }
            
            .controls {
                display: none;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Daily Cleaning Work Schedule</h1>
        
        <div class="controls">
            <label for="hours"># of Hours:</label>
            <select id="hours" onchange="generateSchedule()">
                <option value="5">5 Hours</option>
                <option value="6">6 Hours</option>
                <option value="7">7 Hours</option>
                <option value="8" selected>8 Hours</option>
                <option value="9">9 Hours</option>
            </select>
            <div class="control-group">
            <label>Start Time:</label>
            <div class="time-inputs">
                <select id="startHour" onchange="generateSchedule()">
                    <option value="6">6 AM</option>
                    <option value="7">7 AM</option>
                    <option value="8" selected>8 AM</option>
                    <option value="9">9 AM</option>
                    <option value="10">10 AM</option>
                    <option value="11">11 AM</option>
                    <option value="12">12 PM</option>
                </select>
                <select id="startMinute" onchange="generateSchedule()">
                    <option value="0" selected>:00</option>
                    <option value="30">:30</option>
                </select>
            </div>
        </div>
        </div>
        
        <div id="schedule"></div>
    </div>

    <script>
        function addMinutes(time, minutes) {
            const [hours, mins] = time.split(':').map(Number);
            const date = new Date(2000, 0, 1, hours, mins);
            date.setMinutes(date.getMinutes() + minutes);
            
            let h = date.getHours();
            let m = String(date.getMinutes()).padStart(2, '0');
            let period = h >= 12 ? 'PM' : 'AM';
            h = h % 12 || 12; // Convert to 12-hour format, 0 becomes 12
            
            return `${h}:${m} ${period}`;
        }

        function generateSchedule() {
            const totalHours = parseInt(document.getElementById('hours').value);
            const workHours = totalHours - 1; // Subtract 1 hour break
            const needsMicroBreaks = totalHours >= 8;
            
            let schedule = [];
            const startHour = document.getElementById('startHour').value;
            const startMinute = document.getElementById('startMinute').value;
            let currentTime = `${startHour}:${startMinute.padStart(2, '0')}`;
            
            // Calculate lunch time ONCE outside the loop
            const [startH, startM] = currentTime.split(':').map(Number);
            const startMinutes = startH * 60 + startM;
            const endMinutes = startMinutes + (totalHours * 60);
            const midpointMinutes = Math.floor((startMinutes + endMinutes) / 2);
            const lunchTime = midpointMinutes + 30;
            
            // Morning: Daily task (1.5 hours)
            schedule.push({
                start: currentTime,
                end: addMinutes(currentTime, 90),
                task: 'Same daily task',
                type: 'daily'
            });
            currentTime = addMinutes(currentTime, 90);
            
            // Calculate remaining work time
            let remainingMinutes = (workHours * 60) - 90; // Subtract daily task
            
            // Variables for task tracking
            let isHeavy = true;
            let microBreakCounter = 0;
            let tasksSinceMicroBreak = 0;
            
            while (remainingMinutes > 0) {
                const [h, m] = currentTime.split(':').map(Number);
                const currentMinutes = h * 60 + m;
                
                // Check if we've reached lunch time
                if (!schedule.some(s => s.type === 'break') && currentMinutes >= lunchTime) {
                    const lunchHour = Math.floor(lunchTime / 60);
                    const lunchMin = lunchTime % 60;
                    const lunchStartRaw = `${lunchHour}:${String(lunchMin).padStart(2, '0')}`;
                    const lunchStart = addMinutes(lunchStartRaw, 0); // Format with AM/PM
                    const lunchEnd = addMinutes(lunchStartRaw, 60);
                    
                    schedule.push({
                        start: lunchStart,
                        end: lunchEnd,
                        task: 'Break',
                        type: 'break'
                    });
                    currentTime = lunchEnd;
                    continue;
                }
                
                // Add micro-break divider if needed
                if (needsMicroBreaks && tasksSinceMicroBreak >= 2 && microBreakCounter < 5 && remainingMinutes > 45) {
                    schedule.push({
                        type: 'micro-break-divider'
                    });
                    microBreakCounter++;
                    tasksSinceMicroBreak = 0;
                }
                
                let duration = Math.min(45, remainingMinutes);
                let taskType, taskLabel;
                
                // Determine task type based on position
                if (currentMinutes < lunchTime) {
                    // Morning: alternate heavy/light
                    taskType = isHeavy ? 'heavy' : 'light';
                    taskLabel = isHeavy ? 'Heavy task' : 'Light task';
                } else {
                    // Afternoon: moderate and light
                    if (remainingMinutes <= 15) {
                        taskType = 'light';
                        taskLabel = 'Very light / finishing tasks';
                    } else if (remainingMinutes <= 45) {
                        taskType = 'moderate';
                        taskLabel = 'Moderate/light task';
                    } else if (isHeavy) {
                        taskType = 'moderate';
                        taskLabel = 'Moderate task';
                    } else {
                        taskType = 'light';
                        taskLabel = 'Light task';
                    }
                }
                
                schedule.push({
                    start: currentTime,
                    end: addMinutes(currentTime, duration),
                    task: taskLabel,
                    type: taskType
                });
                
                currentTime = addMinutes(currentTime, duration);
                remainingMinutes -= duration;
                isHeavy = !isHeavy;
                tasksSinceMicroBreak++;
            }
            
            renderSchedule(schedule);
        }
        
        function renderSchedule(schedule) {
            const scheduleDiv = document.getElementById('schedule');
            let html = '';
            let currentSection = '';
            
            schedule.forEach(item => {
                // Handle micro-break dividers
                if (item.type === 'micro-break-divider') {
                    html += '<div class="micro-break-divider"></div>';
                    return;
                }
                
                // Extract hour from time string with AM/PM
                const timeStr = item.start.split(' ')[0]; // Get "8:00" from "8:00 AM"
                const period = item.start.split(' ')[1]; // Get "AM" or "PM"
                const [h] = timeStr.split(':').map(Number);
                
                // Convert to 24-hour for comparison
                let hour24 = h;
                if (period === 'PM' && h !== 12) hour24 = h + 12;
                if (period === 'AM' && h === 12) hour24 = 0;
                
                let section = '';
                
                if (hour24 < 12) {
                    section = 'morning';
                } else if (item.type === 'break') {
                    section = 'break';
                } else {
                    section = 'afternoon';
                }
                
                if (section !== currentSection) {
                    if (currentSection !== '') {
                        html += '</div>';
                    }
                    
                    let headerText = '';
                    if (section === 'morning') {
                        headerText = 'MORNING SESSION';
                    } else if (section === 'break') {
                        headerText = 'LUNCH BREAK';
                    } else {
                        headerText = 'AFTERNOON SESSION';
                    }
                    
                    html += `<div class="section"><div class="section-header">${headerText}</div>`;
                    currentSection = section;
                }
                
                html += `
                    <div class="task-row">
                        <div class="time">${item.start} â€“ ${item.end}</div>
                        <div class="task">${item.task}</div>
                        <span class="label ${item.type}">${item.type.charAt(0).toUpperCase() + item.type.slice(1).replace('-', ' ')}</span>
                    </div>
                `;
            });
            
            if (currentSection !== '') {
                html += '</div>';
            }
            
            scheduleDiv.innerHTML = html;
        }
        
        // Generate initial schedule
        generateSchedule();
    </script>
</body>
</html>
