<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Booster Pack Generator</title>
    <style>
        body {
            font-family: 'Courier New', monospace;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
        }
        .container {
            max-width: 1400px;
            width: 100%;
        }
        h1 {
            color: #d4af37;
            text-align: center;
            margin-bottom: 30px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
            font-size: 2.5em;
        }
        .pack-container {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
            margin-bottom: 30px;
            min-height: 500px;
        }
        .card {
            width: 220px;
            height: 340px;
            background: linear-gradient(135deg, #2a2a2a 0%, #1a1a1a 100%);
            border-radius: 12px;
            padding: 0;
            position: relative;
            transition: transform 0.3s ease;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
            overflow: hidden;
        }
        .card:hover {
            transform: translateY(-10px) scale(1.05);
        }
        .card.reveal {
            animation: cardReveal 0.6s ease-out;
        }
        @keyframes cardReveal {
            0% {
                opacity: 0;
                transform: rotateY(90deg) scale(0.8);
            }
            100% {
                opacity: 1;
                transform: rotateY(0deg) scale(1);
            }
        }
        .card-border {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            border-radius: 12px;
            padding: 3px;
            pointer-events: none;
        }
        .card-border.common { background: linear-gradient(135deg, #9d9d9d, #7a7a7a); }
        .card-border.uncommon { background: linear-gradient(135deg, #1eff00, #15c900); }
        .card-border.rare { background: linear-gradient(135deg, #0070dd, #005bb5); }
        .card-border.epic { background: linear-gradient(135deg, #a335ee, #8a2ac7); }
        .card-border.legendary { background: linear-gradient(135deg, #ff8000, #cc6600); }
        .card-content {
            position: relative;
            background: linear-gradient(135deg, #2a2a2a 0%, #1a1a1a 100%);
            border-radius: 10px;
            height: 100%;
            display: flex;
            flex-direction: column;
            padding: 12px;
        }
        .card-header {
            text-align: center;
            margin-bottom: 10px;
        }
        .card-rarity {
            font-size: 0.75em;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 5px;
        }
        .card-rarity.common { color: #9d9d9d; }
        .card-rarity.uncommon { color: #1eff00; }
        .card-rarity.rare { color: #0070dd; }
        .card-rarity.epic { color: #a335ee; }
        .card-rarity.legendary { color: #ff8000; }
        .card-name {
            font-size: 1.1em;
            font-weight: bold;
            color: #ffd700;
            margin-bottom: 10px;
            line-height: 1.2;
            min-height: 45px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .card-art {
            background: radial-gradient(circle, rgba(255,255,255,0.05) 0%, rgba(0,0,0,0.3) 100%);
            border: 2px solid #444;
            border-radius: 8px;
            height: 140px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3em;
            margin-bottom: 10px;
            position: relative;
            overflow: hidden;
        }
        .card-art::before {
            content: '‚öîÔ∏è';
            opacity: 0.3;
            font-size: 1.5em;
        }
        .card-stats {
            background: rgba(0, 0, 0, 0.4);
            border: 1px solid #555;
            border-radius: 6px;
            padding: 8px;
            margin-bottom: 8px;
            font-size: 0.85em;
        }
        .stat-line {
            display: flex;
            justify-content: space-between;
            color: #00ff00;
            margin: 3px 0;
        }
        .stat-label {
            color: #aaa;
        }
        .card-description {
            flex-grow: 1;
            background: rgba(0, 0, 0, 0.4);
            border: 1px solid #555;
            border-radius: 6px;
            padding: 8px;
            font-size: 0.75em;
            color: #ccc;
            font-style: italic;
            margin-bottom: 8px;
        }
        .card-value {
            background: rgba(212, 175, 55, 0.2);
            border: 1px solid #d4af37;
            border-radius: 6px;
            padding: 6px;
            text-align: center;
            font-size: 0.8em;
            color: #d4af37;
            font-weight: bold;
        }
        button {
            display: block;
            margin: 0 auto;
            padding: 18px 40px;
            background: linear-gradient(135deg, #d4af37 0%, #f2d06b 100%);
            border: none;
            border-radius: 8px;
            font-size: 20px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            color: #000;
            box-shadow: 0 4px 15px rgba(212, 175, 55, 0.4);
        }
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 25px rgba(212, 175, 55, 0.6);
        }
        button:active {
            transform: translateY(0);
        }
        .placeholder {
            display: flex;
            align-items: center;
            justify-content: center;
            color: #666;
            font-size: 0.9em;
            text-align: center;
            padding: 20px;
        }
        .sealed-pack {
            position: relative;
            width: 260px;
            height: 360px;
            cursor: pointer;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            animation: packPulse 1.6s ease-in-out infinite;
        }
        
        .pack-image {
            width: 100%;
            height: auto;
            border-radius: 10px;
            box-shadow: 0 8px 20px rgba(0,0,0,0.4);
            transition: transform 0.3s ease, opacity 0.5s ease;
        }
        
        .click-text {
            margin-top: 10px;
            color: #ffd700;
            font-weight: bold;
            text-shadow: 2px 2px 4px black;
        }
        
        @keyframes packPulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.03); }
            100% { transform: scale(1); }
        }
        
        .pack-opening {
            animation: openPackAnim 0.8s ease forwards;
        }
        
        @keyframes openPackAnim {
            0% { opacity: 1; transform: scale(1) rotate(0); }
            100% { opacity: 0; transform: scale(1.2) rotate(8deg); }
        }
        
        /* Stack of card backs */
        .card-back-stack {
            width: 220px;
            height: 340px;
            position: relative;
            margin: auto;
            cursor: pointer;
        }
        
        .card-back {
            position: absolute;
            width: 220px;
            height: 340px;
        
            background-image: url("https://cdn.funkypigeon.com/supplier_back_images/cardback_danilo_shrek_p.jpg");
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
        
            border-radius: 12px;
            border: 3px solid #444;
        
            box-shadow: 0 8px 25px rgba(0,0,0,0.4);
        
            transition: opacity 0.4s ease, transform 0.4s ease;
            cursor: pointer;
        }


        
        .card-back:nth-child(1) { transform: rotate(-3deg) translateY(-6px); }
        .card-back:nth-child(2) { transform: rotate(2deg) translateY(-3px); }
        .card-back:nth-child(3) { transform: rotate(-1deg); }

        .rarity-common {
            box-shadow: 0 0 12px 2px rgba(150,150,150,0.4);
        }
        
        .rarity-uncommon {
            box-shadow: 0 0 14px 3px rgba(30,255,0,0.55);
        }
        
        .rarity-rare {
            box-shadow: 0 0 16px 4px rgba(0,110,255,0.6);
        }
        
        .rarity-epic {
            box-shadow: 0 0 18px 5px rgba(163,53,238,0.7);
        }
        
        .rarity-legendary {
            box-shadow: 0 0 22px 6px rgba(255,128,0,0.85);
        }
        .card-back::before,
        .card-back::after {
            content: none !important;
        }    
        .flip-card {
            width: 220px;
            height: 340px;
            perspective: 1200px;
            cursor: default;
            
        .flip-card.can-flip {
            cursor: pointer; /* NEW: Override to show clickable cursor when ready to flip */
        }
        
        .flip-inner {
            width: 100%;
            height: 100%;
            position: relative;
            transition: transform 0.7s ease;
            transform-style: preserve-3d;
        }
        
        .flip-card.flipped .flip-inner {
            transform: rotateY(180deg);
        }
        
        .flip-front,
        .flip-back {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden; /* CRITICAL */
            border-radius: 12px;
        }
        
        /* Card Back */
        .flip-back {
            background-image: url("https://cdn.funkypigeon.com/supplier_back_images/cardback_danilo_shrek_p.jpg");
            background-size: cover;
            background-position: center;
        }
        
        /* Card Front (your generated card) */
        .flip-front {
            transform: rotateY(180deg); /* CRITICAL */
        }

    </style>
</head>
<body>
    <div class="container">
        <h1>üÉè Booster Pack Generator üÉè</h1>
        <div class="pack-container" id="packContainer">
            <div id="sealedPack" class="sealed-pack">
                <img src="https://opengameart.org/sites/default/files/card%20back%20black.png" alt="Booster Pack" class="pack-image">
            <div class="click-text">Click to open</div>
            </div>
</div>

        <button onclick="resetPack()">Open Booster Pack</button>
    </div>

    <script>
        const data = {
            rarities: ['COMMON', 'UNCOMMON', 'RARE', 'EPIC', 'LEGENDARY'],
            
            commonPrefixes: ['Worn', 'Old', 'Simple', 'Basic', 'Plain', 'Crude', 'Rusty', 'Dull', 'Chipped', 'Tarnished'],
            uncommonPrefixes: ['Sturdy', 'Fine', 'Quality', 'Polished', 'Sharp', 'Reinforced', 'Balanced', 'Crafted', 'Solid', 'Reliable'],
            rarePrefixes: ['Blessed', 'Enhanced', 'Superior', 'Enchanted', 'Radiant', 'Gleaming', 'Masterwork', 'Exquisite', 'Pristine', 'Glorious'],
            epicPrefixes: ['Ancient', 'Divine', 'Celestial', 'Eternal', 'Supreme', 'Mythic', 'Transcendent', 'Ascendant', 'Hallowed', 'Majestic'],
            
            items: ['Darts', 'Sword', 'Shield', 'Amulet', 'Ring', 'Helmet', 'Boots', 'Gauntlets', 'Cloak', 'Staff', 'Blade', 'Axe', 'Bow', 'Wand', 'Orb'],
            
            rareSuffixes: ['of the Wolf', 'of the Bear', 'of the Eagle', 'of the Serpent', 'of the Tiger', 'of the Dragon', 'of the Phoenix', 'of the Lion'],
            epicSuffixes: ['of the Warlock', 'of the Paladin', 'of the Archmage', 'of the Berserker', 'of the Assassin', 'of the Champion', 'of the Warlord', 'of the Sage'],
            
            legendaryPart1: ['Void', 'Star', 'Soul', 'Death', 'Life', 'Storm', 'Shadow', 'Light', 'Frost', 'Flame', 'Blood', 'Dawn', 'Dusk', 'Moon', 'Sun'],
            legendaryPart2: ['bringer', 'reaver', 'render', 'fang', 'claw', 'seeker', 'fury', 'bane', 'heart', 'breaker', 'singer', 'caller', 'weaver', 'forged'],
            
            stats: ['NOM', 'SHAME', 'GLORY', 'POWER', 'SPEED', 'WISDOM', 'CHAOS', 'ORDER', 'LUCK', 'GRIT'],
            comparisons: ['chocolate', 'velvet', 'marble', 'glass', 'steel', 'silk', 'smoke', 'lightning', 'water', 'fire', 'ice', 'stone', 'wood', 'gold']
        };

        function random(min, max) {
            return Math.floor(Math.random() * (max - min + 1)) + min;
        }

        function pick(array) {
            return array[Math.floor(Math.random() * array.length)];
        }

        function pickRarity() {
            const roll = Math.random() * 100;
            
            if (roll < 50) return 'COMMON';
            if (roll < 75) return 'UNCOMMON';
            if (roll < 90) return 'RARE';
            if (roll < 97) return 'EPIC';
            return 'LEGENDARY';
        }

        function generateItem() {
            const rarity = pickRarity();
            
            let name;
            switch(rarity) {
                case 'COMMON':
                    name = `${pick(data.commonPrefixes)} ${pick(data.items)}`;
                    break;
                case 'UNCOMMON':
                    name = `${pick(data.uncommonPrefixes)} ${pick(data.items)}`;
                    break;
                case 'RARE':
                    name = `${pick(data.rarePrefixes)} ${pick(data.items)} ${pick(data.rareSuffixes)}`;
                    break;
                case 'EPIC':
                    name = `${pick(data.epicPrefixes)} ${pick(data.items)} ${pick(data.epicSuffixes)}`;
                    break;
                case 'LEGENDARY':
                    name = `${pick(data.legendaryPart1)}${pick(data.legendaryPart2)}`;
                    break;
            }
            
            const stat1 = pick(data.stats);
            const stat1Value = random(-5, 20);
            const stat1Sign = stat1Value >= 0 ? '+' : '';
            
            let stat2 = pick(data.stats);
            while (stat2 === stat1) {
                stat2 = pick(data.stats);
            }
            const stat2Value = random(-5, 20);
            const stat2Sign = stat2Value >= 0 ? '+' : '';
            
            const comparison = pick(data.comparisons);
            
            let gold, silver, copper;
            switch(rarity) {
                case 'COMMON':
                    gold = 0;
                    silver = random(0, 5);
                    copper = random(0, 99);
                    break;
                case 'UNCOMMON':
                    gold = random(0, 2);
                    silver = random(0, 99);
                    copper = random(0, 99);
                    break;
                case 'RARE':
                    gold = random(3, 25);
                    silver = random(0, 99);
                    copper = random(0, 99);
                    break;
                case 'EPIC':
                    gold = random(26, 150);
                    silver = random(0, 99);
                    copper = random(0, 99);
                    break;
                case 'LEGENDARY':
                    gold = random(151, 999);
                    silver = random(0, 99);
                    copper = random(0, 99);
                    break;
            }
            
            return {
                rarity,
                name,
                stat1,
                stat1Value,
                stat1Sign,
                stat2,
                stat2Value,
                stat2Sign,
                comparison,
                gold,
                silver,
                copper
            };
        }

        function createCard(item, delay) {
            const rarityClass = item.rarity.toLowerCase();
            
            const card = document.createElement('div');
            card.className = 'card';
            card.style.animationDelay = `${delay}s`;
            
            setTimeout(() => {
                card.classList.add('reveal');
            }, delay * 1000);
            
            card.innerHTML = `
                <div class="card-border ${rarityClass}">
                    <div class="card-content">
                        <div class="card-header">
                            <div class="card-rarity ${rarityClass}">${item.rarity}</div>
                            <div class="card-name">${item.name}</div>
                        </div>
                        <div class="card-art"></div>
                        <div class="card-stats">
                            <div class="stat-line">
                                <span class="stat-label">${item.stat1}</span>
                                <span>${item.stat1Sign}${item.stat1Value}</span>
                            </div>
                            <div class="stat-line">
                                <span class="stat-label">${item.stat2}</span>
                                <span>${item.stat2Sign}${item.stat2Value}</span>
                            </div>
                        </div>
                        <div class="card-description">
                            It looks kind of like ${item.comparison}.
                        </div>
                        <div class="card-value">
                            ${item.gold}g ${item.silver}s ${item.copper}c
                        </div>
                    </div>
                </div>
            `;
            
            return card;
        }

        let packOpened = false;
        let backsRevealed = false;
        
        document.getElementById("sealedPack").addEventListener("click", () => {
            if (packOpened) return;
        
            packOpened = true;
            const sealed = document.getElementById("sealedPack");
        
            // Animate the pack tearing/fading out
            sealed.classList.add("pack-opening");
        
            setTimeout(() => {
                sealed.remove();
                showCardBacks();
            }, 800);
        });
        
        let generatedItems = [];

        function showCardBacks() {
            const container = document.getElementById("packContainer");
        
            // Create items early so we know rarity
            generatedItems = [];
            for (let i = 0; i < 5; i++) {
                generatedItems.push(generateItem());
            }
        
            container.innerHTML = "";
        
            const positions = [
                { x: -260, y: -20, r: -8 },
                { x: -130, y: 10,  r: -4 },
                { x:   0,  y: 20,  r: 0 },
                { x: 130,  y: 10,  r: 4 },
                { x: 260,  y: -20, r: 8 }
            ];
        
            // Make a wrapper for animation
            const backWrapper = document.createElement("div");
            backWrapper.style.position = "relative";
            backWrapper.style.width = "100%";
            backWrapper.style.height = "380px";
            backWrapper.style.display = "flex";
            backWrapper.style.alignItems = "center";
            backWrapper.style.justifyContent = "center";
            container.appendChild(backWrapper);
        
            // --- NEW: Define the total delay for all cards to finish spreading ---
            // 5 cards * 120ms interval + a buffer for the transition (0.7s)
            const PLACEMENT_DELAY = 1500; 

            generatedItems.forEach((item, i) => {
                const rarityClass = item.rarity.toLowerCase();
        
                // wrapper for flipping
                const wrapper = document.createElement("div");
                wrapper.className = `flip-card rarity-${rarityClass}`;
                wrapper.style.position = "absolute";
                wrapper.style.opacity = "0";
                // Start position before the spread animation
                wrapper.style.transform = "translate(0,0) rotate(0deg)"; 
                wrapper.style.transition = "all 0.7s ease";
                
                // inner rotating div
                const inner = document.createElement("div");
                inner.className = "flip-inner";
                
                // back side (Shrek)
                const flipBack = document.createElement("div");
                flipBack.className = "flip-back";
                
                // front side (generated card)
                const flipFront = document.createElement("div");
                flipFront.className = "flip-front";
                flipFront.appendChild(createCard(item, 0));  // your card front HTML
                
                // assemble
                inner.appendChild(flipBack);
                inner.appendChild(flipFront);
                wrapper.appendChild(inner);
                backWrapper.appendChild(wrapper);
                
                // NEW: Flip behavior function
                const flipCard = () => {
                    // Only flip if the card has the 'can-flip' class (meaning placement is done)
                    if (!wrapper.classList.contains('can-flip')) return;
                    
                    // Prevent subsequent flips on the same card
                    wrapper.removeEventListener('click', flipCard); 
                    wrapper.classList.add("flipped");
                
                    if (!backsRevealed) {
                        backsRevealed = true;
                        // You can adjust this to a "Reveal All" button later if desired
                    }
                };

                // Attach the event listener
                wrapper.addEventListener("click", flipCard);
                
                // Fan animation: Start the spread after a small staggered delay
                setTimeout(() => {
                    wrapper.style.opacity = "1";
                    // Move the card to its final spread-out position
                    wrapper.style.transform =
                        `translate(${positions[i].x}px, ${positions[i].y}px) rotate(${positions[i].r}deg)`;
                }, 50 + i * 120);

            });

            // NEW: After the cards are done spreading, enable the flip mechanism
            setTimeout(() => {
                document.querySelectorAll('.flip-card').forEach(card => {
                    card.classList.add('can-flip');
                });
            }, PLACEMENT_DELAY);
        }
        
        function revealFromBacks(container) {
            container.innerHTML = "";
            generatedItems.forEach((item, i) => {
                const card = createCard(item, i * 0.15);
                container.appendChild(card);
            });
        }



        function openPack() {
            const container = document.getElementById('packContainer');
            container.innerHTML = '';
            
            // Generate 5 cards
            for (let i = 0; i < 5; i++) {
                const item = generateItem();
                const card = createCard(item, i * 0.15);
                container.appendChild(card);
            }
        }

        // Load data from files when available
        async function loadDataFromFiles() {
            const files = [
                'rarities', 
                'commonPrefixes', 'uncommonPrefixes', 'rarePrefixes', 'epicPrefixes',
                'items', 
                'rareSuffixes', 'epicSuffixes',
                'legendaryPart1', 'legendaryPart2',
                'stats', 'comparisons'
            ];
            
            for (const file of files) {
                try {
                    const response = await fetch(`names/${file}.txt`);
                    if (response.ok) {
                        const text = await response.text();
                        data[file] = text.split('\n').filter(line => line.trim());
                    }
                } catch (e) {
                    console.log(`Could not load ${file}.txt, using defaults`);
                }
            }
        }

        function resetPack() {
            packOpened = false;
            backsRevealed = false;
            generatedItems = [];
        
            const container = document.getElementById("packContainer");
            container.innerHTML = `
                <div id="sealedPack" class="sealed-pack">
                    <img src="https://i.imgur.com/7l1R4Hn.png" alt="Booster Pack" class="pack-image">
                    <div class="click-text">Click to open</div>
                </div>
            `;
        
            // Reattach the click listener to the fresh sealed pack
            document.getElementById("sealedPack").addEventListener("click", () => {
                if (packOpened) return;
        
                packOpened = true;
                const sealed = document.getElementById("sealedPack");
                sealed.classList.add("pack-opening");
        
                setTimeout(() => {
                    sealed.remove();
                    showCardBacks();
                }, 800);
            });
        }


        loadDataFromFiles();
    </script>
</body>
</html>
